<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏</title>
    <link rel="stylesheet" href="admin.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé® –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏</h1>
            <p>–î–∏–∞–≥—Ä–∞–º–º—ã —Ä–µ–π—Ç–∏–Ω–≥–æ–≤, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–µ–π</p>
            <div class="nav">
                <a href="index.html" class="nav-btn">üè† –ì–ª–∞–≤–Ω–∞—è</a>
                <a href="admin.html" class="nav-btn">‚öôÔ∏è –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</a>
            </div>
        </div>

        <div class="content">
            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="stats" id="statsSection">
                <div class="stat-card">
                    <h3>–í—Å–µ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</h3>
                    <div class="number" id="totalImages">0</div>
                </div>
                <div class="stat-card">
                    <h3>–í–∏–¥–∏–º—ã—Ö</h3>
                    <div class="number" id="visibleImages">0</div>
                </div>
                <div class="stat-card">
                    <h3>–°–∫—Ä—ã—Ç—ã—Ö</h3>
                    <div class="number" id="hiddenImages">0</div>
                </div>
                <div class="stat-card">
                    <h3>–û–±—â–∏–π —Ä–µ–π—Ç–∏–Ω–≥</h3>
                    <div class="number" id="totalRating">0</div>
                </div>
            </div>

            <!-- –î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ -->
            <div class="section">
                <div class="section-header" onclick="toggleRatingsChart()">
                    <h2>üìä –î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤</h2>
                    <span class="collapse-icon" id="collapseIcon">‚ñº</span>
                </div>
                
                <div class="section-content" id="ratingsChartContent">
                    <!-- –≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π -->
                    <div class="sort-controls">
                        <select id="sortBy" class="sort-select">
                            <option value="total">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –æ–±—â–µ–º—É —Ä–µ–π—Ç–∏–Ω–≥—É</option>
                            <option value="likes">–ü–æ –ª–∞–π–∫–∞–º (—É–±—ã–≤–∞–Ω–∏–µ)</option>
                            <option value="dislikes">–ü–æ –¥–∏–∑–ª–∞–π–∫–∞–º (—É–±—ã–≤–∞–Ω–∏–µ)</option>
                            <option value="ratio">–ü–æ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—é –ª–∞–π–∫–æ–≤</option>
                            <option value="title">–ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é (–ê-–Ø)</option>
                            <option value="totalRatings">–ü–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –æ—Ü–µ–Ω–æ–∫</option>
                        </select>

                        <select id="filterByTag" class="sort-select">
                            <option value="all">–í—Å–µ —Ç–µ–≥–∏</option>
                        </select>

                        <button class="sort-btn active" onclick="toggleSortOrder()" id="sortOrderBtn">
                            üîΩ –£–±—ã–≤–∞–Ω–∏–µ
                        </button>

                        <button class="btn btn-primary" onclick="refreshChart()">
                            üîÑ –û–±–Ω–æ–≤–∏—Ç—å
                        </button>
                    </div>

                    <!-- –õ–µ–≥–µ–Ω–¥–∞ –¥–∏–∞–≥—Ä–∞–º–º—ã -->
                    <div class="chart-legend">
                        <div class="legend-item">
                            <div class="legend-color legend-likes"></div>
                            <span>–õ–∞–π–∫–∏ üëç</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color legend-dislikes"></div>
                            <span>–î–∏–∑–ª–∞–π–∫–∏ üëé</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #6c757d;"></div>
                            <span>–î–ª–∏–Ω–∞ = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ü–µ–Ω–æ–∫</span>
                        </div>
                    </div>

                    <!-- –®–∫–∞–ª–∞ –º–∞—Å—à—Ç–∞–±–∞ -->
                    <div class="chart-scale" id="chartScale">
                        <span>0 –æ—Ü–µ–Ω–æ–∫</span>
                        <span id="maxRatings">0 –æ—Ü–µ–Ω–æ–∫</span>
                    </div>

                    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º—ã -->
                    <div class="ratings-chart" id="ratingsChart">
                        <div class="no-data">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</div>
                    </div>
                </div>
            </div>

            <!-- –ñ—É—Ä–Ω–∞–ª –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
            <div class="section">
                <div class="section-header" onclick="toggleLogsSection()">
                    <h2>üìã –ñ—É—Ä–Ω–∞–ª –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h2>
                    <span class="collapse-icon" id="logsCollapseIcon">‚ñº</span>
                </div>
                
                <div class="section-content" id="logsSectionContent">
                    <!-- –≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–æ–≥–∞–º–∏ -->
                    <div class="logs-controls">
                        <div class="filter-group">
                            <label for="logActionFilter">–î–µ–π—Å—Ç–≤–∏–µ:</label>
                            <select id="logActionFilter" class="form-control">
                                <option value="all">–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è</option>
                                <option value="PAGE_LOAD">–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã</option>
                                <option value="LIKE">–õ–∞–π–∫</option>
                                <option value="DISLIKE">–î–∏–∑–ª–∞–π–∫</option>
                                <option value="PAGE_CHANGE">–°–º–µ–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã</option>
                                <option value="ITEMS_PER_PAGE_CHANGE">–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞</option>
                                <option value="FILTER_CHANGE">–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞</option>
                                <option value="FILTER_RESET">–°–±—Ä–æ—Å —Ñ–∏–ª—å—Ç—Ä–∞</option>
                                <option value="GALLERY_REFRESH">–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–∞–ª–µ—Ä–µ–∏</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label for="logDateFilter">–ü–µ—Ä–∏–æ–¥:</label>
                            <select id="logDateFilter" class="form-control">
                                <option value="all">–ó–∞ –≤—Å—ë –≤—Ä–µ–º—è</option>
                                <option value="today">–°–µ–≥–æ–¥–Ω—è</option>
                                <option value="week">–ó–∞ –Ω–µ–¥–µ–ª—é</option>
                                <option value="month">–ó–∞ –º–µ—Å—è—Ü</option>
                            </select>
                        </div>
                        
                        <div class="logs-actions">
                            <button class="btn btn-primary" onclick="refreshLogs()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                            <button class="btn btn-success" onclick="exportLogs()">üì• –≠–∫—Å–ø–æ—Ä—Ç –≤ JSON</button>
                            <button class="btn btn-danger" onclick="clearLogs()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏</button>
                            <button class="btn btn-info" onclick="importLogs()">üì§ –ò–º–ø–æ—Ä—Ç –ª–æ–≥–æ–≤</button>
                        </div>
                    </div>

                    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ª–æ–≥–æ–≤ -->
                    <div class="logs-stats" id="logsStats">
                        <div class="stat-item">–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π: <span id="totalLogs">0</span></div>
                        <div class="stat-item">–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–µ—Å—Å–∏–π: <span id="uniqueSessions">0</span></div>
                        <div class="stat-item">–ü–µ—Ä–∏–æ–¥: <span id="logsPeriod">-</span></div>
                    </div>

                    <!-- –¢–∞–±–ª–∏—Ü–∞ –ª–æ–≥–æ–≤ -->
                    <div class="table-container">
                        <table class="logs-table">
                            <thead>
                                <tr>
                                    <th onclick="sortLogs('timestamp')">–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è ‚åµ</th>
                                    <th onclick="sortLogs('action')">–î–µ–π—Å—Ç–≤–∏–µ ‚åµ</th>
                                    <th onclick="sortLogs('details')">–î–µ—Ç–∞–ª–∏ ‚åµ</th>
                                    <th onclick="sortLogs('sessionId')">–°–µ—Å—Å–∏—è ‚åµ</th>
                                </tr>
                            </thead>
                            <tbody id="logsTableBody">
                                <tr>
                                    <td colspan="4" class="no-data">–ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–≥–æ–≤...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –ª–æ–≥–æ–≤ -->
                    <div class="logs-pagination">
                        <button id="logsPrevPage" class="btn btn-outline">‚Üê –ù–∞–∑–∞–¥</button>
                        <span id="logsPageInfo">–°—Ç—Ä–∞–Ω–∏—Ü–∞ 1 –∏–∑ 1</span>
                        <button id="logsNextPage" class="btn btn-outline">–í–ø–µ—Ä—ë–¥ ‚Üí</button>
                    </div>
                </div>
            </div>

            <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
            <div class="alert" id="alertMessage"></div>

            <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
            <div class="section">
                <h2 id="formTitle">‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</h2>
                <form id="imageForm">
                    <input type="hidden" id="editId">
                    
                    <div class="form-group">
                        <label for="imageTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è *</label>
                        <input type="text" id="imageTitle" class="form-control" required>
                    </div>

                    <div class="form-group">
                        <label>–ò—Å—Ç–æ—á–Ω–∏–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</label>
                        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                            <button type="button" class="btn btn-primary" onclick="showUrlInput()">üîó –ü–æ URL</button>
                            <button type="button" class="btn btn-success" onclick="showFileInput()">üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª</button>
                        </div>
                        
                        <div id="urlInput" style="display: none;">
                            <input type="url" id="imageUrl" class="form-control" placeholder="https://example.com/image.jpg">
                        </div>
                        
                        <div id="fileInput" style="display: none;">
                            <div class="upload-area" onclick="document.getElementById('fileUpload').click()">
                                <p>üìÅ –ù–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞ –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Å—é–¥–∞</p>
                                <input type="file" id="fileUpload" accept="image/*" style="display: none;">
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</label>
                        <img id="imagePreview" class="image-preview" alt="–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä">
                    </div>

                    <div class="form-group">
                        <label for="imageTags">–¢–µ–≥–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                        <input type="text" id="imageTags" class="form-control" placeholder="–ø—Ä–∏—Ä–æ–¥–∞, –∑–∞–∫–∞—Ç, –≤–æ–¥–∞">
                    </div>

                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="imageHidden"> –°–∫—Ä—ã—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                        </label>
                    </div>

                    <div style="display: flex; gap: 10px;">
                        <button type="submit" class="btn btn-primary" id="submitBtn">–î–æ–±–∞–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</button>
                        <button type="button" class="btn btn-danger" onclick="resetForm()" style="display: none;" id="cancelBtn">–û—Ç–º–µ–Ω–∞</button>
                    </div>
                </form>
            </div>

            <!-- –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã -->
            <div class="section">
                <h2>üîç –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è</h2>
                <div class="search-box">
                    <input type="text" id="searchInput" class="form-control" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é...">
                </div>
                <div id="tagFilter" class="tag-list"></div>
            </div>

            <!-- –°–ø–∏—Å–æ–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π -->
            <div class="section">
                <h2>üñºÔ∏è –í—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</h2>
                <div class="images-grid" id="imagesGrid"></div>
            </div>
        </div>
    </div>

    <!-- –°–∫—Ä—ã—Ç—ã–π input –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ —Ñ–∞–π–ª–æ–≤ -->
    <input type="file" id="logsFileInput" accept=".json" style="display: none;">

    <script src="admin.js"></script>
</body>
</html>